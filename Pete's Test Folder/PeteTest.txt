This is a merge of mine and Brandon
